

对于内购和第三方支付的流程, 各自应该都是差不多的,至少对于我们这里的实现是差不多的

微信支付:
在入口需要传递的参数


有一个大的分类:
内购和第三方支付, 这里需要有一个枚举, 用来指明需要走的是哪个方式的支付设置
目前是可以沿用现有的枚举: 微信, 支付宝, 苹果和谷歌

最外层的接口包, 将每一个支付的类型都列出来, 参数都归各自管理'''

本地微信的实现:
1. 先是请求api(参数: 子账户名, 支付渠道, 总金额, 数量), 获取到支付凭证
2. 检查能否跳转微信, 如果可以, 则使用 SyFlutterWeixin 的 pay 方法, 传入由支付凭证构造好的 SyPayInfo
3. pay方法内部会找到TlFluwx的实现, 由实现去调用微信插件的 payWithWeChat 方法
   appId：微信开放平台审核通过的应用APPID。
   partnerId：微信支付商户号，即商户身份ID。
   prepayId：微信返回的支付交易会话ID。从服务器端获取。
   nonceStr：随机字符串，不长于32位。推荐随机数生成算法。
   timeStamp：时间戳，具体见微信官网文档。
   packageValue：订单详情扩展字符串，统一下单接口返回的prepay_id参数值，此处即为"Sign=WXPay"。
   sign：签名，具体请参照微信官网文档进行签名处理。

   signType参数为签名类型，一般为MD5或者HMAC-SHA256，在支付请求的签名中也要使用这个参数，以便微信系统识别。对于Flutter中的微信支付插件，通常情况下我们不需要设置这个参数，因为插件已经默认使用了MD5的签名方式。
   extData参数为扩展参数，我们可以在这个参数中传递一些额外的信息，例如商品描述，商户订单号等。这个参数和具体场景有关，如果需要使用的话，我们需要在服务端生成好订单后，将这些信息一并传递给客户端，客户端在调用支付接口时作为extData参数的值传递即可。如果不需要使用，可以不用传递。
4. 然后等待返回, 使用 SyFlutterWeixin 监听支付完成, 需要传入一个回调, 在支付完成后执行, 监听在插件内已经做好了, 只需要传递回调
5. 等待微信监听返回支付成功后, 轮询获取余额, 直到查询成功后, 就算是充值完毕, 间隔5秒,查询五次


本地apple的实现:
1. 需要先向服务器查询有无未验证通过的订单, 如果有则需要等待订单完成
2. 向服务器查询商品价格等信息
3. 尝试链接对应的内购平台
4. 根据当前的商品列表获取商品信息, 但是并没有接收保存下来?
5. 使用不同的原生方法去做跳转
6. 等待重置结果返回

/// 检查服务器是否有未验证的apple订单
Future<void> checkApplePay();

/// 检查服务器是否有未验证的google订单
Future<void> checkGooglePay();




先写业务,然后再拆底层的东西出去
tl的接口包还是要分开出来,然后业务这边,也是只实现一套接口,实现里面再去拆分平台,使用枚举判断

